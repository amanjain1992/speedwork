!function(t){var e="speedRender",n={response_target:".ac-ajax-content",total_target:".ac-ajax-total",loadmore:".ac-load-more",overlayclass:"render-overlay",append:!1,data:{}},o=function(e,o){return this.element=e,this.settings=t.extend({},n,o),t.metadata&&(this.settings=t.extend({},this.settings,e.metadata({type:"class"})),this.settings=t.extend({},this.settings,e.metadata({type:"html5"}))),this.form=e.is("form")?e:e.parents("form:eq(0)"),this.form?(this.init(),void this.submit()):!1};o.prototype.init=function(){var e=this;t(e.form).on("click",".ac-ajax-pagination a",function(n){n.preventDefault();var o=t(this).data("page");return o?(e.form.find("input[name=page]").val(o),e.settings.append=!1,this.formSubmit(),!1):!1}),t(e.form).on("click",e.settings.loadmore,function(n){n.preventDefault();var o=t(this).data("page");return e.form.find("input[name=page]").val(o),e.settings.append=!0,this.formSubmit(),!1}),t(window).scroll(function(){var n=e.form.find(e.settings.loadmore).offset(),o=n?n.top:0;if(isNaN(o)||0==o)return!1;if(oldtop!=o){oldtop=o;var i=e.form.find("input[name=page]").val();3>i&&(ps_loaded=!1)}!ps_loaded&&t(window).scrollTop()+t(window).height()>o&&(ps_loaded=!0,e.form.find(e.settings.loadmore).click())})},o.prototype.submit=function(){var t=this;t.form.submit(function(e){return e.preventDefault(),t.formSubmit(),!1})},o.prototype.formSubmit=function(){var e=this,n=e.settings.data;n.type="html";var o={beforeSubmit:function(){e.beforeSubmit()},success:function(t){e.onSuccess(t)},data:n};console.log("loaded");var i=t.extend({},this.settings,o);this.element.ajaxSubmit(i)},o.prototype.beforeSubmit=function(){var t=this,e=t.form.find(t.settings.response_target);return e.addClass(t.settings.overlayclass),t.form.find(t.settings.loadmore).next(".ac-load-more-loading").show(),t.form.find(t.settings.loadmore).remove(),!0},o.prototype.onSuccess=function(t){var e=this;this.callback("onComplete",t);var n=e.form.find(e.settings.response_target);if(e.settings.append)e.form.find(".ac-load-more-remove").remove(),n.append(t);else{var o=e.form.find("[data-total]").data("total");e.form.find("input[name=total]").val(o),e.form.find(e.settings.total_target).html(o),n.html(t)}n.removeClass(e.settings.overlayclass)},o.prototype.callback=function(t,e){var n=this,o=n.settings[t];if(o&&"undefined"!=typeof o)if("function"==typeof o)o(e,n,n.settings);else{var i=window[o];"function"==typeof i&&i(e,n,n.settings)}var a=t.toLowerCase(),o=n.settings[a];if(o&&"undefined"!=typeof o)if("function"==typeof o)o(e,n,n.settings);else{var i=window[o];"function"==typeof i&&i(e,n,n.settings)}var o=n.form.find("#"+t).val();if(""!=o&&"undefined"!=typeof o){var i=window[o];"function"==typeof i&&i(e,n,n.settings)}},t.fn.speedRender=function(n){return this.each(function(){t.data(this,e)||t.data(this,e,new o(t(this),n))})}}(jQuery);