function getForm(t){var a=null;if(t.parents("form:eq(0)").length>0)var a=t.parents("form:eq(0)");else if(t.parents().find(".ac-filter-form").length>0)var a=jQuery(".ac-filter-form");else var a=jQuery("#ajax_form");return a}function displayNoty(t,a,e){noty("OK"==t.status?{text:t.message,type:"success",layout:"topCenter"}:"INFO"==t.status?{text:t.message,type:"info",layout:"topCenter"}:{text:t.message,type:"error",layout:"topCenter"}),"function"==typeof a?a(t,e):"function"==typeof window[a]&&window[a](t,e)}$(document).ready(function(){if($(document).on("click","[data-href]",function(t){var a=$(this),e=a.data("callback");$.ajax({url:$(this).data("href"),data:{format:"json"},success:function(t){displayNoty(t,e,a)}}),t.preventDefault()}),$(document).on("click",'.ac-action-delete, [data-delete], [data-action="delete"]',function(t){if(!confirm(_e("Are you sure want to delete?")))return!1;var a=$(this),e=a.attr("data-tag")||"tr",n=a.parents(e+":eq(0)"),o=$(this).attr("href")||a.data("delete");$.ajax({url:o,data:{format:"json"},success:function(t){"OK"==t.status&&(n.remove(),$(".ac-ajax-total").html(parseInt($(".ac-ajax-total").text())-1)),displayNoty(t)}}),t.preventDefault()}),$(document).on("click",".ac-action-request",function(t){var a=$(this),e=$(this).attr("href")||a.data("status");$.ajax({url:e,data:{format:"json"},success:function(t){displayNoty(t)}}),t.preventDefault()}),$(document).on("click",".ac-action-status a",function(t){var a=$(this),e=a.parent(".ac-action-status");$.ajax({url:e.data("link"),data:{status:a.data("status"),format:"json"},success:function(t){"OK"==t.status&&(e.find("a:hidden").show(),a.hide()),displayNoty(t)}}),t.preventDefault()}),$(document).on("change",".ac-action-status select",function(t){var a=$(this),e=a.parent(".ac-action-status"),n=$(this).val();$.ajax({url:e.data("link"),data:{status:n,format:"json"},success:function(t){displayNoty(t)}}),t.preventDefault()}),$(document).on("click",".ac-action-request-confirm",function(t){if(!confirm(_e("Are you sure want to proceed?")))return!1;$(this);$.ajax({url:$(this).attr("href"),data:{format:"json"},success:function(t){displayNoty(t)}}),t.preventDefault()}),$(document).on("click",".ac-filter-reset",function(t){var a=getForm($(this));a[0].reset(),t.preventDefault(),a.submit(),$("[placeholder]").placeholder(),$.browser.msie&&init()}),$(document).on("click",".ac-filter-export",function(t){var a=$(this),e=getForm(a);$.fn.clearWatermark();var n=a.attr("base-href");void 0===n&&a.attr("base-href",a.attr("href")),a.attr("href",a.attr("base-href")+"&"+e.serialize())}),$(document).on("click","[data-task]",function(t){t.preventDefault();var a=$(this),e=getForm(a),n=a.data("task"),o=a.data("task-name")||"task",r=e.find("input[name='"+o+"']");r.length>0?r.val(n):jQuery("<input/>",{name:o,value:n,type:"hidden"}).appendTo(e),e.submit()}),$(document).on("click","[data-order]",function(t){t.preventDefault();var a=jQuery(this).attr("data-order"),e=jQuery(this).attr("data-order-type");jQuery(this).addClass("ordering");var n=1;new RegExp("ASC").test(e)&&(n=0),1==n?(jQuery(this).attr("data-order-type","ASC"),jQuery(this).removeClass("desc"),jQuery(this).addClass("asc"),jQuery(this).children("i").removeClass("fa-sort-amount-desc").addClass("fa-sort-amount-asc")):(jQuery(this).removeClass("asc"),jQuery(this).addClass("desc"),jQuery(this).attr("data-order-type","DESC"),jQuery(this).children("i").removeClass("fa-sort-amount-asc").addClass("fa-sort-amount-desc"));var o=getForm($(this));o.find(".ac-sort-name").length>0?jQuery(".ac-sort-name").val(a):jQuery("<input/>",{"class":"ac-sort-name",name:"sort",value:a,type:"hidden"}).appendTo(o),o.find(".ac-sort-order").length>0?jQuery(".ac-sort-order").val(e):jQuery("<input/>",{"class":"ac-sort-order",name:"order",value:e,type:"hidden"}).appendTo(o),o.submit()}),$(document).on("click","[data-prevent],.quickboxmodal,.qtipmodal,.quickbox,.qtipbox",function(t){t.preventDefault()}),$.fn.sortable){var t=function(t,a){return a.children().each(function(){$(this).width($(this).width())}),a},a=function(t,a){var e=getForm($(this));return e.find(".ac-task-input").length>0?jQuery(".ac-task-input").val("sorting"):jQuery("<input/>",{"class":"ac-task-input",name:"task",value:"sorting",type:"hidden"}).appendTo(e),e.submit(),a};$(".table_sortable_body").sortable({connectWith:[".table_sortable_body"],handle:".griddragdrop",opacity:.6,helper:t,update:a}).disableSelection()}$.fn.autocomplete&&$("[data-auto]").livequery(function(){var t=$(this),a={minLength:2,delay:100,source:function(a,e){$.ajax({url:_link(t.data("auto")),data:{task:"auto",q:a.term,format:"json",options:t.data("options")},success:function(t){e(t)}})},select:function(t,a){var e=a.item.id;$(this).parent().find("[data-auto-value]").val(e),$(this).next(".ac-auto-value:first").val(e)},change:function(t,a){a.item||$(this).val("")}};$(this).autocomplete(a).data("ui-autocomplete")._renderItem=function(t,a){return $("<li></li>").data("item.autocomplete",a).append(a.label).appendTo(t)}}),$.fn.tokenfield&&$("[data-token]").livequery(function(){var t=$(this),a={minLength:2,delay:100,source:function(a,e){$.ajax({url:_link(t.data("token")),data:{task:"auto",q:a.term,format:"json",options:t.data("options")},success:function(t){e(t)}})}},e=[];try{e=$.parseJSON(t.attr("tokens"))}catch(n){console.log(n)}t.tokenfield({tokens:e,autocomplete:a}).on("tokenfield:createtoken",function(t){var a=$(this).tokenfield("getTokens");$.each(a,function(a,e){e.value===t.attrs.value&&t.preventDefault()})})}),$(document).on("click",".ac-go-top",function(){jQuery("html, body").animate({scrollTop:0},500)}),$(window).scroll(function(){jQuery(window).scrollTop()<=250?jQuery(".ac-go-top").fadeOut(500):jQuery(".ac-go-top").fadeIn(500)})});