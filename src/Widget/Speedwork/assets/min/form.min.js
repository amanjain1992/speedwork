!function(e){function t(){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}e.fn.ajaxSubmit=function(r){function a(a){function i(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function o(){function r(){try{var e=i(p).readyState;t("state = "+e),"uninitialized"==e.toLowerCase()&&setTimeout(r,50)}catch(a){t("Server abort: ",a," (",a.name,")"),u(k),x&&clearTimeout(x),x=void 0}}var a=s.attr("target"),o=s.attr("action");y.setAttribute("target",m),n||y.setAttribute("method","POST"),o!=c.url&&y.setAttribute("action",c.url),c.skipEncodingOverride||n&&!/post/i.test(n)||s.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),c.timeout&&(x=setTimeout(function(){b=!0,u(T)},c.timeout)),e('<input type="hidden" name="_request" value="iframe" />').appendTo(y);var l=[];try{if(c.extraData)for(var f in c.extraData)l.push(e('<input type="hidden" name="'+f+'" />').attr("value",c.extraData[f]).appendTo(y)[0]);c.iframeTarget||(d.appendTo("body"),p.attachEvent?p.attachEvent("onload",u):p.addEventListener("load",u,!1)),setTimeout(r,15),y.submit()}finally{y.setAttribute("action",o),a?y.setAttribute("target",a):s.removeAttr("target"),e(l).remove()}}function u(r){if(!v.aborted&&!S){try{j=i(p)}catch(a){t("cannot access response document: ",a),r=k}if(r===T&&v)return void v.abort("timeout");if(r==k&&v)return void v.abort("server abort");if(j&&j.location.href!=c.iframeSrc||b){p.detachEvent?p.detachEvent("onload",u):p.removeEventListener("load",u,!1);var n,o="success";try{if(b)throw"timeout";var s="xml"==c.dataType||j.XMLDocument||e.isXMLDoc(j);if(t("isXml="+s),!s&&window.opera&&(null==j.body||""==j.body.innerHTML)&&--L)return t("requeing onLoad callback, DOM not available"),void setTimeout(u,250);var l=j.body?j.body:j.documentElement;v.responseText=l?l.innerHTML:null,v.responseXML=j.XMLDocument?j.XMLDocument:j,s&&(c.dataType="xml"),v.getResponseHeader=function(e){var t={"content-type":c.dataType};return t[e]},l&&(v.status=Number(l.getAttribute("status"))||v.status,v.statusText=l.getAttribute("statusText")||v.statusText);var m=c.dataType||c.format,d=/(json|script|text)/.test(m.toLowerCase());if(d||c.textarea){var h=j.getElementsByTagName("textarea")[0];if(h)v.responseText=h.value,v.status=Number(h.getAttribute("status"))||v.status,v.statusText=h.getAttribute("statusText")||v.statusText;else if(d){var g=j.getElementsByTagName("pre")[0],y=j.getElementsByTagName("body")[0];g?v.responseText=g.textContent?g.textContent:g.innerHTML:y&&(v.responseText=y.innerHTML)}}else"xml"!=c.dataType||v.responseXML||null==v.responseText||(v.responseXML=A(v.responseText));try{w=E(v,c.dataType,c)}catch(r){o="parsererror",v.error=n=r||o}}catch(r){t("error caught: ",r),o="error",v.error=n=r||o}v.aborted&&(t("upload aborted"),o=null),v.status&&(o=v.status>=200&&v.status<300||304===v.status?"success":"error"),"success"===o?(c.success&&c.success.call(c.context,w,"success",v),f&&e.event.trigger("ajaxSuccess",[v,c])):o&&(void 0==n&&(n=v.statusText),c.error&&c.error.call(c.context,v,o,n),f&&e.event.trigger("ajaxError",[v,c,n])),f&&e.event.trigger("ajaxComplete",[v,c]),f&&!--e.active&&e.event.trigger("ajaxStop"),c.complete&&c.complete.call(c.context,v,o),S=!0,c.timeout&&clearTimeout(x),setTimeout(function(){c.iframeTarget||(v.responseXML=null)},100)}}}var l,c,f,m,d,p,v,h,g,b,x,y=s[0];if(a)for(l=0;l<a.length;l++)e(y[a[l].name]).attr("disabled",!1);if(e(":input[name=submit],:input[id=submit]",y).length)return void alert('Error: Form elements must not have name or id of "submit".');if(c=e.extend(!0,{},e.ajaxSettings,r),c.context=c.context||c,m="jqFormIO"+(new Date).getTime(),c.iframeTarget?(d=e(c.iframeTarget),g=d.attr("name"),null==g?d.attr("name",m):m=g):(d=e('<iframe name="'+m+'" src="'+c.iframeSrc+'" />'),d.css({position:"absolute",top:"-1000px",left:"-1000px"}),console.log("I frame loadd")),p=d[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(r){var a="timeout"===r?"timeout":"aborted";t("aborting upload... "+a),this.aborted=1,d.attr("src",c.iframeSrc),v.error=a,c.error&&c.error.call(c.context,v,a,r),f&&e.event.trigger("ajaxError",[v,c,a]),c.complete&&c.complete.call(c.context,v,a)}},f=c.global,f&&!e.active++&&e.event.trigger("ajaxStart"),f&&e.event.trigger("ajaxSend",[v,c]),c.beforeSend&&c.beforeSend.call(c.context,v,c)===!1)return void(c.global&&e.active--);if(!v.aborted){h=y.clk,h&&(g=h.name,g&&!h.disabled&&(c.extraData=c.extraData||{},c.extraData[g]=h.value,"image"==h.type&&(c.extraData[g+".x"]=y.clk_x,c.extraData[g+".y"]=y.clk_y)));var T=1,k=2;c.forceSync?o():setTimeout(o,10);var w,j,S,L=50,A=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},D=e.parseJSON||function(e){return window.eval("("+e+")")},E=function(t,r,a){var n=t.getResponseHeader("content-type")||"",i="xml"===r||!r&&n.indexOf("xml")>=0,o=i?t.responseXML:t.responseText;return i&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),a&&a.dataFilter&&(o=a.dataFilter(o,r)),"string"==typeof o&&("json"===r||!r&&n.indexOf("json")>=0?o=D(o):("script"===r||!r&&n.indexOf("javascript")>=0)&&e.globalEval(o)),o}}}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;var n,i,o,s=this;"function"==typeof r&&(r={success:r}),n=this.attr("method"),i=this.attr("action"),o="string"==typeof i?e.trim(i):"",o=o||window.location.href||"",o&&(o=(o.match(/^([^#]+)/)||[])[1]),r=e.extend(!0,{url:o,success:e.ajaxSettings.success,type:n||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},r);var u={};if(this.trigger("form-pre-serialize",[this,r,u]),u.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(r.beforeSerialize&&r.beforeSerialize(this,r)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var l,c,f=this.formToArray(r.semantic);if(r.data){r.extraData=r.data;for(l in r.data)if(r.data[l]instanceof Array)for(var m in r.data[l])f.push({name:l,value:r.data[l][m]});else c=r.data[l],c=e.isFunction(c)?c():c,f.push({name:l,value:c})}if(r.beforeSubmit&&r.beforeSubmit(f,this,r)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[f,this,r,u]),u.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var d=e.param(f);"GET"==r.type.toUpperCase()?(r.url+=(r.url.indexOf("?")>=0?"&":"?")+d,r.data=null):r.data=d;var p=[];if(r.resetForm&&p.push(function(){s.resetForm()}),r.clearForm&&p.push(function(){s.clearForm()}),!r.dataType&&r.target){var v=r.success||function(){};p.push(function(t){var a=r.replaceTarget?"replaceWith":"html";e(r.target)[a](t).each(v,arguments)})}else r.success&&p.push(r.success);r.success=function(e,t,a){for(var n=r.context||r,i=0,o=p.length;o>i;i++)p[i].apply(n,[e,t,a||s,s,r])};var h=e("input:file",this).length>0,g="multipart/form-data",b=s.attr("enctype")==g||s.attr("encoding")==g;if(r.iframe!==!1&&(h||r.iframe||b))r.closeKeepAlive?e.get(r.closeKeepAlive,function(){a(f)}):a(f);else{if(e.browser.msie&&"get"==n){var x=s[0].getAttribute("method");"string"==typeof x&&(r.type=x)}e.ajax(r)}return this.trigger("form-submit-notify",[this,r]),this},e.fn.ajaxForm=function(r){if(0===this.length){var a={s:this.selector,c:this.context};return!e.isReady&&a.s?(t("DOM not ready, queuing ajaxForm"),e(function(){e(a.s,a.c).ajaxForm(r)}),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(r))}).bind("click.form-plugin",function(t){var r=t.target,a=e(r);if(!a.is(":submit,input:image")){var n=a.closest(":submit");if(0==n.length)return;r=n[0]}var i=this;if(i.clk=r,"image"==r.type)if(void 0!=t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var o=a.offset();i.clk_x=t.pageX-o.left,i.clk_y=t.pageY-o.top}else i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var r=[];if(0===this.length)return r;var a=this[0],n=t?a.getElementsByTagName("*"):a.elements;if(!n)return r;var i,o,s,u,l,c,f;for(i=0,c=n.length;c>i;i++)if(l=n[i],s=l.name)if(t&&a.clk&&"image"==l.type)l.disabled||a.clk!=l||(r.push({name:s,value:e(l).val()}),r.push({name:s+".x",value:a.clk_x},{name:s+".y",value:a.clk_y}));else if(u=e.fieldValue(l,!0),u&&u.constructor==Array)for(o=0,f=u.length;f>o;o++)r.push({name:s,value:u[o]});else null!==u&&"undefined"!=typeof u&&r.push({name:s,value:u});if(!t&&a.clk){var m=e(a.clk),d=m[0];s=d.name,s&&!d.disabled&&"image"==d.type&&(r.push({name:s,value:m.val()}),r.push({name:s+".x",value:a.clk_x},{name:s+".y",value:a.clk_y}))}return r},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var r=[];return this.each(function(){var a=this.name;if(a){var n=e.fieldValue(this,t);if(n&&n.constructor==Array)for(var i=0,o=n.length;o>i;i++)r.push({name:a,value:n[i]});else null!==n&&"undefined"!=typeof n&&r.push({name:this.name,value:n})}}),e.param(r)},e.fn.fieldValue=function(t){for(var r=[],a=0,n=this.length;n>a;a++){var i=this[a],o=e.fieldValue(i,t);null===o||"undefined"==typeof o||o.constructor==Array&&!o.length||(o.constructor==Array?e.merge(r,o):r.push(o))}return r},e.fieldValue=function(t,r){var a=t.name,n=t.type,i=t.tagName.toLowerCase();if(void 0===r&&(r=!0),r&&(!a||t.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!t.checked||("submit"==n||"image"==n)&&t.form&&t.form.clk!=t||"select"==i&&-1==t.selectedIndex))return null;if("select"==i){var o=t.selectedIndex;if(0>o)return null;for(var s=[],u=t.options,l="select-one"==n,c=l?o+1:u.length,f=l?o:0;c>f;f++){var m=u[f];if(m.selected){var d=m.value;if(d||(d=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),l)return d;s.push(d)}}return s}return e(t).val()},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,r=this.tagName.toLowerCase();e.test(t)||"textarea"==r?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==r&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var r=this.type;if("checkbox"==r||"radio"==r)this.checked=t;else if("option"==this.tagName.toLowerCase()){var a=e(this).parent("select");t&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=t}})}}(jQuery);